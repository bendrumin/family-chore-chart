<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ChoreStar - Make chores fun with stars, progress tracking, and family rewards">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ChoreStar">
    <title>ChoreStar - Family Chore Chart</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🏠</text></svg>">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhcl8xXzEpIi8+CjxwYXRoIGQ9Ik05NiA0OEM3Ny4xNjQ5IDQ4IDYyIDYzLjE2NDkgNjIgODJWNzJDNjIgNTMuMTY0OSA3Ny4xNjQ5IDM4IDk2IDM4QzExNC44MzUgMzggMTMwIDUzLjE2NDkgMTMwIDcyVjgyQzEzMCA2My4xNjQ5IDExNC44MzUgNDggOTYgNDhaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTEwIDEwNkMxMTAgOTcuNzE2NSA5OS4yODM1IDg3IDEwMCA4N0MxMDAuNzE2NSA4NyAxMTAgOTcuNzE2NSAxMTAgMTA2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTgyIDEwNkM4MiA5Ny43MTY1IDkyLjcxNjUgODcgOTIgODdDOTIuNzE2NSA4NyA4MiA5Ny43MTY1IDgyIDEwNloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik05NiAxNTZDNzcuMTY0OSAxNTYgNjIgMTQwLjgzNSA2MiAxMjJWNzJDNjIgNTMuMTY0OSA3Ny4xNjQ5IDM4IDk2IDM4QzExNC44MzUgMzggMTMwIDUzLjE2NDkgMTMwIDcyVjEyMkMxMzAgMTQwLjgzNSAxMTQuODM1IDE1NiA5NiAxNTZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTEwIDEwNkMxMTAgOTcuNzE2NSA5OS4yODM1IDg3IDEwMCA4N0MxMDAuNzE2NSA4NyAxMTAgOTcuNzE2NSAxMTAgMTA2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTgyIDEwNkM4MiA5Ny43MTY1IDkyLjcxNjUgODcgOTIgODdDOTIuNzE2NSA4NyA4MiA5Ny43MTY1IDgyIDEwNloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik05NiAxNTZDNzcuMTY0OSAxNTYgNjIgMTQwLjgzNSA2MiAxMjJWNzJDNjIgNTMuMTY0OSA3Ny4xNjQ5IDM4IDk2IDM4QzExNC44MzUgMzggMTMwIDUzLjE2NDkgMTMwIDcyVjEyMkMxMzAgMTQwLjgzNSAxMTQuODM1IDE1NiA5NiAxNTZaIiBmaWxsPSJ3aGl0ZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDBfbGluZWFyXzFfMSIgeDE9IjAiIHkxPSIwIiB4Mj0iMTkyIiB5Mj0iMTkyIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiM2NjdlZWEiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNzY0YmEiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-746ST4RH2E"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-746ST4RH2E', {
            page_title: 'ChoreStar - Family Chore Chart',
            custom_map: {
                'custom_parameter_1': 'user_type',
                'custom_parameter_2': 'subscription_status',
                'custom_parameter_3': 'children_count'
            }
        });
    </script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>Loading Family Chore Chart...</h2>
            <p>Getting everything ready for your family! 🏠</p>
        </div>
    </div>

    <!-- Auth Container -->
    <div id="auth-container" class="auth-container hidden">
        <div class="auth-card">
            <div class="auth-header">
                <h1>🏠 Family Chore Chart</h1>
                <p>Track chores, earn rewards, and have fun together!</p>
            </div>
            
            <!-- Login Form -->
            <form id="login-form" class="auth-form">
                <h2>Welcome Back!</h2>
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" required>
                </div>
                <button type="submit" class="btn btn-primary">Sign In</button>
                <p class="auth-switch">
                    Don't have an account? 
                    <a href="#" id="show-signup">Create one here</a>
                </p>
                <p class="auth-switch">
                    <a href="#" id="forgot-password">Forgot password?</a>
                </p>
                <div class="auth-divider">
                    <span>or</span>
                </div>
                <button type="button" id="show-pin-login" class="btn btn-secondary">
                    🔢 Sign in with PIN
                </button>
            </form>
            
            <!-- PIN Login Form -->
            <form id="pin-login-form" class="auth-form hidden">
                <h2>🔢 Sign in with PIN</h2>
                <p class="pin-description">Perfect for kids! Enter your family's 4-digit PIN to sign in.</p>
                <div class="form-group">
                    <label for="pin-code">Family PIN</label>
                    <input type="text" id="pin-code" maxlength="4" placeholder="1234" required>
                    <small>Enter the 4-digit PIN your family uses</small>
                </div>
                <button type="submit" class="btn btn-primary">🔓 Sign In</button>
                <p class="auth-switch">
                    <a href="#" id="back-to-email-login">Back to email login</a>
                </p>
                <p class="auth-switch">
                    <a href="#" id="show-signup-from-pin">Create new account</a>
                </p>
            </form>
            
            <!-- Signup Form -->
            <form id="signup-form" class="auth-form hidden">
                <h2>Create Family Account</h2>
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" required>
                </div>
                <div class="form-group">
                    <label for="signup-family-name">Family Name</label>
                    <input type="text" id="signup-family-name" required placeholder="e.g., The Smith Family">
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" required minlength="6">
                </div>
                <div class="form-group">
                    <label for="signup-confirm-password">Confirm Password</label>
                    <input type="password" id="signup-confirm-password" required minlength="6">
                </div>
                <button type="submit" class="btn btn-primary">Create Account</button>
                <p class="auth-switch">
                    Already have an account? 
                    <a href="#" id="show-login">Sign in here</a>
                </p>
            </form>
            
            <!-- Forgot Password Form -->
            <form id="forgot-form" class="auth-form hidden">
                <h2>Reset Password</h2>
                <p>Enter your email and we'll send you a reset link.</p>
                <div class="form-group">
                    <label for="forgot-email">Email</label>
                    <input type="email" id="forgot-email" required>
                </div>
                <button type="submit" class="btn btn-primary">Send Reset Link</button>
                <p class="auth-switch">
                    <a href="#" id="back-to-login">Back to login</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="app-container hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-left">
                    <h1>🏠 Family Chore Chart</h1>
                    <p id="family-name">Loading...</p>
                </div>
                <div class="header-right">
                    <button id="add-child-btn" class="btn btn-secondary">
                        <span>👶</span> Add Child
                    </button>
                    <button id="settings-btn" class="btn btn-secondary">
                        <span>⚙️</span> Settings
                    </button>
                    <button id="logout-btn" class="btn btn-secondary">
                        <span>🚪</span> Logout
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Children Grid -->
            <div id="children-grid" class="children-grid">
                <!-- Children will be dynamically added here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state hidden">
                <div class="empty-content">
                    <h2>👶 Welcome to Your Family Chore Chart!</h2>
                    <p>Start by adding your first child to begin tracking chores and rewards.</p>
                    <button id="empty-add-child-btn" class="btn btn-primary">
                        <span>👶</span> Add Your First Child
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    
    <!-- Add Child Modal -->
    <div id="add-child-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>👶 Add New Child</h2>
                <button class="modal-close" data-modal="add-child-modal">&times;</button>
            </div>
            <form id="add-child-form" class="modal-form">
                <div class="form-group">
                    <label for="child-name">Child's Name</label>
                    <input type="text" id="child-name" required placeholder="e.g., Emma">
                </div>
                <div class="form-group">
                    <label for="child-age">Age</label>
                    <input type="number" id="child-age" min="1" max="18" required>
                </div>
                <div class="form-group">
                    <label for="child-color">Avatar Color</label>
                    <div class="color-picker">
                        <input type="color" id="child-color" value="#6366f1">
                        <div class="color-presets">
                            <button type="button" class="color-preset" data-color="#6366f1" style="background: #6366f1;"></button>
                            <button type="button" class="color-preset" data-color="#10b981" style="background: #10b981;"></button>
                            <button type="button" class="color-preset" data-color="#f59e0b" style="background: #f59e0b;"></button>
                            <button type="button" class="color-preset" data-color="#ef4444" style="background: #ef4444;"></button>
                            <button type="button" class="color-preset" data-color="#8b5cf6" style="background: #8b5cf6;"></button>
                            <button type="button" class="color-preset" data-color="#ec4899" style="background: #ec4899;"></button>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" data-modal="add-child-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Child</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Chore Modal -->
    <div id="add-chore-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>📝 Add New Chores</h2>
                <button class="modal-close" data-modal="add-chore-modal">&times;</button>
            </div>
            <form id="add-chore-form" class="modal-form">
                <div class="form-group">
                    <label for="chore-child">For Child</label>
                    <select id="chore-child" required>
                        <option value="">Select a child...</option>
                    </select>
                </div>
                
                <div id="chores-container">
                    <div class="chore-entry">
                        <div class="chore-entry-header">
                            <h3>Chore #1</h3>
                            <button type="button" class="btn btn-outline btn-sm remove-chore" style="display: none;">Remove</button>
                        </div>
                        <div class="form-group">
                            <label for="chore-name-1">Chore Name</label>
                            <input type="text" id="chore-name-1" required placeholder="e.g., Make bed">
                        </div>
                        <div class="form-group">
                            <small style="color: var(--gray-600);">Each completed day earns 7¢</small>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="add-more-chore">
                        <span>➕</span> Add Another Chore
                    </button>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" data-modal="add-chore-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add All Chores</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Chore Modal -->
    <div id="edit-chore-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>✏️ Edit Chore</h2>
                <button class="modal-close" data-modal="edit-chore-modal">&times;</button>
            </div>
            <form id="edit-chore-form" class="modal-form edit-chore-form">
                <div class="form-group">
                    <label for="edit-chore-name">Chore Name</label>
                    <input type="text" id="edit-chore-name" required placeholder="e.g., Make bed">
                </div>
                <div class="form-group">
                    <label for="edit-chore-child">For Child</label>
                    <select id="edit-chore-child" required>
                        <option value="">Select a child...</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" data-modal="edit-chore-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>⚙️ Family Settings</h2>
                <button class="modal-close" data-modal="settings-modal">&times;</button>
            </div>
            <form id="settings-form" class="modal-form">
                <div class="form-group">
                    <label for="daily-reward">Daily Reward (cents)</label>
                    <input type="number" id="daily-reward" min="1" max="100" value="7" required>
                    <small>Amount earned per day when all chores are completed</small>
                </div>
                <div class="form-group">
                    <label for="weekly-bonus">Weekly Bonus (cents)</label>
                    <input type="number" id="weekly-bonus" min="0" max="50" value="1" required>
                    <small>Bonus for completing all chores all week</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" data-modal="settings-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>
            </form>
            
            <hr style="margin: var(--space-6) 0; border: none; border-top: 1px solid var(--gray-200);">
            
            <div class="pin-management">
                <h3>🔢 Family PIN</h3>
                <p class="settings-description">Set a 4-digit PIN for easy kid-friendly login. Perfect for young children who can't handle email/password!</p>
                <div class="form-group">
                    <label for="family-pin">4-Digit PIN</label>
                    <input type="text" id="family-pin" maxlength="4" placeholder="1234">
                    <small>Enter a 4-digit PIN that your family will use to sign in</small>
                </div>
                <div class="form-actions">
                    <button type="button" id="save-pin-btn" class="btn btn-primary">Save PIN</button>
                </div>
            </div>
            
            <hr style="margin: var(--space-6) 0; border: none; border-top: 1px solid var(--gray-200);">
            
            <div class="children-management">
                <h3>Manage Children</h3>
                <div id="children-list" class="children-list">
                    <!-- Children will be populated here -->
                </div>
            </div>
            
            <hr style="margin: var(--space-6) 0; border: none; border-top: 1px solid var(--gray-200);">
            
            <div class="chore-management">
                <h3>Manage Chores</h3>
                <div id="chores-list" class="chores-list">
                    <!-- Chores will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Family Sharing Modal -->
    <div id="family-sharing-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>👨‍👩‍👧‍👦 Family Sharing</h2>
                <button class="modal-close" data-modal="family-sharing-modal">&times;</button>
            </div>
            <div class="modal-form">
                <div class="family-sharing-content">
                    <div class="share-family-section">
                        <h3>📤 Share Your Family</h3>
                        <p>Share this code with family members to let them join your ChoreStar family!</p>
                        <div class="family-code-display">
                            <div class="code-box">
                                <span id="family-code">Loading...</span>
                                <button class="btn btn-secondary btn-sm" onclick="app.copyFamilyCode()">
                                    📋 Copy
                                </button>
                            </div>
                        </div>
                        <div class="family-members">
                            <h4>👥 Family Members</h4>
                            <div id="family-members-list">
                                <!-- Family members will be listed here -->
                            </div>
                        </div>
                    </div>
                    
                    <hr style="margin: var(--space-6) 0; border: none; border-top: 1px solid var(--gray-200);">
                    
                    <div class="join-family-section">
                        <h3>📥 Join a Family</h3>
                        <p>Enter a 6-digit family code to join another family's ChoreStar!</p>
                        <form id="join-family-form" class="join-family-form">
                            <div class="form-group">
                                <label for="join-family-code">Family Code</label>
                                <input type="text" id="join-family-code" maxlength="6" placeholder="123456" required>
                                <small>Enter the 6-digit code shared with you</small>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Join Family</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="supabase-config.js"></script>
    <script src="api-client.js"></script>
    <script src="analytics.js"></script>
    <script src="notifications.js"></script>
    <script src="family-sharing.js"></script>
    <script src="script.js"></script>
</body>
</html> 